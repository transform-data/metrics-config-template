version: v0.1
data_source:
  name: rainfall_fct
  description: rainfall across all weather stations, starting in Oct 2020.
  owners:
    - support@transformdata.io
  sql_query: |
    SELECT
      's98356237'              AS id_station
      , 0.200                  AS m_rainfall
      , '2020-10-01'           AS ds
    UNION ALL SELECT 's59936436', 0.001, '2020-10-01'
    UNION ALL SELECT 's98356237', 0.810, '2020-10-02'
    UNION ALL SELECT 's59936436', 0.110, '2020-10-02'
    UNION ALL SELECT 's98356237', 0.001, '2020-10-03'
    UNION ALL SELECT 's59936436', 0.150, '2020-10-03'
    UNION ALL SELECT 's98356237', 0.760, '2020-10-04'
    UNION ALL SELECT 's59936436', 0.980, '2020-10-04'

  identifiers:
    - name: station
      type: foreign
      expr: id_station

  measures:
    - name: rainfall
      description: rainfall measured in inches
      expr: m_rainfall
      agg: sum

  dimensions:
    - name: ds
      type: time
    - name: is_trace
      type: categorical
      expr: CASE WHEN m_rainfall = 0.001 THEN TRUE ELSE FALSE END

  mutability:
    type: immutable
