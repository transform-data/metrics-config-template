data_source:
  name: customer_dim
  description: Location and description of all customers
  owners:
    - support@transformdata.io

  identifiers:
    - name: customer
      type: primary
      expr: id_customer

  measures:
    - name: new_customers
      expr: "1"
      agg: SUM

  dimensions:
    - name: ds
      type: time
      type_params:
        is_primary: True
        time_granularity: day
    - name: country
      description: The country where the customer is located.
      type: categorical

  mutability:
    type: immutable

  # CAST(col as TIMESTAMP) not required when using columns from a data warehouse table or SQL statement based off of a table. It is used here for BigQuery to resolve improperly cast STRING data when using "UNION ALL" data.
  sql_query: |
    SELECT
      id_customer
      , country
      , CAST(ds as TIMESTAMP) AS ds
    FROM (
        SELECT
          'c500003'             AS id_customer
          , 'MX'                AS country
          , '2022-01-25'        AS ds
        UNION ALL SELECT 'c500013', 'BR', '2022-02-01'
        UNION ALL SELECT 'c500108', 'GR', '2022-02-01'
        UNION ALL SELECT 'c500206', 'CA', '2022-02-02'
        UNION ALL SELECT 'c500244', 'FR', '2022-02-02'
        UNION ALL SELECT 'c500396', 'BR', '2022-02-02'
        UNION ALL SELECT 'c500138', 'CA', '2022-02-02'
        UNION ALL SELECT 'c500000', 'US', '2022-02-02'
        UNION ALL SELECT 'c500159', 'CA', '2022-02-02'
        UNION ALL SELECT 'c500184', 'US', '2022-02-02'
        UNION ALL SELECT 'c500333', 'MX', '2022-02-03'
        UNION ALL SELECT 'c500104', 'GR', '2022-02-04'
        UNION ALL SELECT 'c500078', 'US', '2022-02-04'
        UNION ALL SELECT 'c500047', 'GR', '2022-02-04'
        UNION ALL SELECT 'c500093', 'CA', '2022-02-04'
        UNION ALL SELECT 'c500015', 'GR', '2022-02-05'
        UNION ALL SELECT 'c500236', 'BR', '2022-02-05'
        UNION ALL SELECT 'c500155', 'BR', '2022-02-05'
        UNION ALL SELECT 'c500069', 'GR', '2022-02-05'
        UNION ALL SELECT 'c500085', 'US', '2022-02-05'
        UNION ALL SELECT 'c500086', 'FR', '2022-02-06'
        UNION ALL SELECT 'c500195', 'GR', '2022-02-06'
        UNION ALL SELECT 'c500245', 'GR', '2022-02-06'
        UNION ALL SELECT 'c500168', 'MX', '2022-02-06'
        UNION ALL SELECT 'c500045', 'US', '2022-02-07'
        UNION ALL SELECT 'c500102', 'FR', '2022-02-07'
        UNION ALL SELECT 'c500003', 'GR', '2022-02-07'
        UNION ALL SELECT 'c500246', 'GR', '2022-02-07'
        UNION ALL SELECT 'c500039', 'FR', '2022-02-07'
        UNION ALL SELECT 'c500337', 'BR', '2022-02-07'
        UNION ALL SELECT 'c500310', 'US', '2022-02-07'
        UNION ALL SELECT 'c500375', 'MX', '2022-02-08'
        UNION ALL SELECT 'c500235', 'FR', '2022-02-08'
        UNION ALL SELECT 'c500349', 'BR', '2022-02-08'
        UNION ALL SELECT 'c500304', 'FR', '2022-02-09'
        UNION ALL SELECT 'c500089', 'BR', '2022-02-09'
        UNION ALL SELECT 'c500283', 'CA', '2022-02-09'
        UNION ALL SELECT 'c500196', 'MX', '2022-02-09'
        UNION ALL SELECT 'c500158', 'BR', '2022-02-09'
        UNION ALL SELECT 'c500121', 'BR', '2022-02-09'
        UNION ALL SELECT 'c500205', 'BR', '2022-02-09'
        UNION ALL SELECT 'c500031', 'FR', '2022-02-09'
        UNION ALL SELECT 'c500328', 'MX', '2022-02-09'
        UNION ALL SELECT 'c500186', 'FR', '2022-02-10'
        UNION ALL SELECT 'c500119', 'FR', '2022-02-10'
        UNION ALL SELECT 'c500050', 'GR', '2022-02-10'
        UNION ALL SELECT 'c500335', 'GR', '2022-02-10'
        UNION ALL SELECT 'c500081', 'US', '2022-02-10'
        UNION ALL SELECT 'c500117', 'CA', '2022-02-10'
        UNION ALL SELECT 'c500149', 'MX', '2022-02-11'
        UNION ALL SELECT 'c500386', 'CA', '2022-02-11'
        UNION ALL SELECT 'c500084', 'FR', '2022-02-11'
        UNION ALL SELECT 'c500128', 'FR', '2022-02-11'
        UNION ALL SELECT 'c500347', 'GR', '2022-02-12'
        UNION ALL SELECT 'c500311', 'CA', '2022-02-12'
        UNION ALL SELECT 'c500228', 'MX', '2022-02-12'
        UNION ALL SELECT 'c500192', 'BR', '2022-02-12'
        UNION ALL SELECT 'c500112', 'MX', '2022-02-13'
        UNION ALL SELECT 'c500259', 'FR', '2022-02-13'
        UNION ALL SELECT 'c500055', 'US', '2022-02-13'
        UNION ALL SELECT 'c500002', 'BR', '2022-02-14'
        UNION ALL SELECT 'c500312', 'FR', '2022-02-14'
        UNION ALL SELECT 'c500071', 'GR', '2022-02-14'
        UNION ALL SELECT 'c500219', 'GR', '2022-02-14'
        UNION ALL SELECT 'c500096', 'BR', '2022-02-15'
        UNION ALL SELECT 'c500132', 'MX', '2022-02-15'
        UNION ALL SELECT 'c500378', 'BR', '2022-02-15'
        UNION ALL SELECT 'c500163', 'BR', '2022-02-15'
        UNION ALL SELECT 'c500273', 'GR', '2022-02-16'
        UNION ALL SELECT 'c500379', 'US', '2022-02-16'
        UNION ALL SELECT 'c500156', 'GR', '2022-02-16'
        UNION ALL SELECT 'c500230', 'CA', '2022-02-16'
        UNION ALL SELECT 'c500185', 'US', '2022-02-17'
        UNION ALL SELECT 'c500020', 'GR', '2022-02-17'
        UNION ALL SELECT 'c500202', 'CA', '2022-02-17'
        UNION ALL SELECT 'c500142', 'BR', '2022-02-17'
        UNION ALL SELECT 'c500296', 'CA', '2022-02-17'
        UNION ALL SELECT 'c500271', 'FR', '2022-02-18'
        UNION ALL SELECT 'c500026', 'GR', '2022-02-18'
        UNION ALL SELECT 'c500180', 'BR', '2022-02-18'
        UNION ALL SELECT 'c500199', 'GR', '2022-02-18'
        UNION ALL SELECT 'c500383', 'CA', '2022-02-19'
        UNION ALL SELECT 'c500389', 'MX', '2022-02-19'
        UNION ALL SELECT 'c500241', 'FR', '2022-02-20'
        UNION ALL SELECT 'c500364', 'CA', '2022-02-20'
        UNION ALL SELECT 'c500201', 'CA', '2022-02-20'
        UNION ALL SELECT 'c500147', 'BR', '2022-02-21'
        UNION ALL SELECT 'c500249', 'MX', '2022-02-21'
        UNION ALL SELECT 'c500348', 'FR', '2022-02-21'
        UNION ALL SELECT 'c500297', 'US', '2022-02-21'
        UNION ALL SELECT 'c500051', 'GR', '2022-02-21'
        UNION ALL SELECT 'c500024', 'US', '2022-02-21'
        UNION ALL SELECT 'c500075', 'CA', '2022-02-22'
        UNION ALL SELECT 'c500063', 'FR', '2022-02-22'
        UNION ALL SELECT 'c500178', 'CA', '2022-02-22'
        UNION ALL SELECT 'c500212', 'BR', '2022-02-22'
        UNION ALL SELECT 'c500065', 'GR', '2022-02-22'
        UNION ALL SELECT 'c500127', 'US', '2022-02-22'
        UNION ALL SELECT 'c500034', 'FR', '2022-02-23'
        UNION ALL SELECT 'c500068', 'BR', '2022-02-23'
        UNION ALL SELECT 'c500099', 'BR', '2022-02-23'
        UNION ALL SELECT 'c500131', 'BR', '2022-02-23'
        UNION ALL SELECT 'c500313', 'US', '2022-02-23'
        UNION ALL SELECT 'c500362', 'US', '2022-02-24'
        UNION ALL SELECT 'c500302', 'US', '2022-02-24'
        UNION ALL SELECT 'c500116', 'FR', '2022-02-24'
        UNION ALL SELECT 'c500284', 'CA', '2022-02-24'
        UNION ALL SELECT 'c500309', 'BR', '2022-02-24'
        UNION ALL SELECT 'c500036', 'MX', '2022-02-24'
        UNION ALL SELECT 'c500395', 'US', '2022-02-24'
        UNION ALL SELECT 'c500016', 'US', '2022-02-24'
        UNION ALL SELECT 'c500237', 'CA', '2022-02-24'
        UNION ALL SELECT 'c500137', 'FR', '2022-02-24'
        UNION ALL SELECT 'c500306', 'FR', '2022-02-25'
        UNION ALL SELECT 'c500316', 'MX', '2022-02-25'
        UNION ALL SELECT 'c500006', 'CA', '2022-02-25'
        UNION ALL SELECT 'c500303', 'BR', '2022-02-26'
        UNION ALL SELECT 'c500215', 'GR', '2022-02-26'
        UNION ALL SELECT 'c500126', 'BR', '2022-02-26'
        UNION ALL SELECT 'c500238', 'BR', '2022-02-26'
        UNION ALL SELECT 'c500033', 'MX', '2022-02-26'
        UNION ALL SELECT 'c500287', 'MX', '2022-02-27'
        UNION ALL SELECT 'c500225', 'US', '2022-02-27'
        UNION ALL SELECT 'c500067', 'CA', '2022-02-27'
        UNION ALL SELECT 'c500095', 'FR', '2022-02-27'
        UNION ALL SELECT 'c500090', 'BR', '2022-02-27'
        UNION ALL SELECT 'c500169', 'BR', '2022-02-28'
        UNION ALL SELECT 'c500106', 'BR', '2022-02-28'
        UNION ALL SELECT 'c500367', 'MX', '2022-02-28'
        UNION ALL SELECT 'c500266', 'FR', '2022-03-01'
        UNION ALL SELECT 'c500350', 'FR', '2022-03-01'
        UNION ALL SELECT 'c500022', 'CA', '2022-03-01'
        UNION ALL SELECT 'c500263', 'GR', '2022-03-01'
        UNION ALL SELECT 'c500222', 'BR', '2022-03-01'
        UNION ALL SELECT 'c500005', 'US', '2022-03-02'
        UNION ALL SELECT 'c500191', 'FR', '2022-03-02'
        UNION ALL SELECT 'c500209', 'MX', '2022-03-02'
        UNION ALL SELECT 'c500046', 'GR', '2022-03-03'
        UNION ALL SELECT 'c500356', 'BR', '2022-03-03'
        UNION ALL SELECT 'c500141', 'FR', '2022-03-03'
        UNION ALL SELECT 'c500252', 'CA', '2022-03-03'
        UNION ALL SELECT 'c500327', 'US', '2022-03-04'
        UNION ALL SELECT 'c500194', 'CA', '2022-03-04'
        UNION ALL SELECT 'c500098', 'US', '2022-03-04'
        UNION ALL SELECT 'c500342', 'CA', '2022-03-04'
        UNION ALL SELECT 'c500317', 'MX', '2022-03-04'
        UNION ALL SELECT 'c500179', 'MX', '2022-03-04'
        UNION ALL SELECT 'c500025', 'FR', '2022-03-05'
        UNION ALL SELECT 'c500028', 'GR', '2022-03-05'
        UNION ALL SELECT 'c500224', 'FR', '2022-03-05'
        UNION ALL SELECT 'c500140', 'BR', '2022-03-05'
        UNION ALL SELECT 'c500082', 'GR', '2022-03-06'
        UNION ALL SELECT 'c500167', 'US', '2022-03-06'
        UNION ALL SELECT 'c500054', 'BR', '2022-03-06'
        UNION ALL SELECT 'c500088', 'MX', '2022-03-07'
        UNION ALL SELECT 'c500176', 'US', '2022-03-07'
        UNION ALL SELECT 'c500105', 'US', '2022-03-07'
        UNION ALL SELECT 'c500270', 'US', '2022-03-07'
        UNION ALL SELECT 'c500314', 'GR', '2022-03-07'
        UNION ALL SELECT 'c500175', 'FR', '2022-03-07'
        UNION ALL SELECT 'c500077', 'BR', '2022-03-08'
        UNION ALL SELECT 'c500166', 'GR', '2022-03-08'
        UNION ALL SELECT 'c500247', 'FR', '2022-03-08'
        UNION ALL SELECT 'c500052', 'MX', '2022-03-08'
        UNION ALL SELECT 'c500010', 'GR', '2022-03-08'
        UNION ALL SELECT 'c500325', 'FR', '2022-03-09'
        UNION ALL SELECT 'c500101', 'CA', '2022-03-09'
        UNION ALL SELECT 'c500343', 'US', '2022-03-09'
        UNION ALL SELECT 'c500257', 'CA', '2022-03-09'
        UNION ALL SELECT 'c500248', 'GR', '2022-03-09'
        UNION ALL SELECT 'c500331', 'CA', '2022-03-09'
        UNION ALL SELECT 'c500233', 'GR', '2022-03-09'
        UNION ALL SELECT 'c500255', 'CA', '2022-03-09'
        UNION ALL SELECT 'c500029', 'BR', '2022-03-09'
        UNION ALL SELECT 'c500062', 'FR', '2022-03-10'
        UNION ALL SELECT 'c500012', 'FR', '2022-03-10'
        UNION ALL SELECT 'c500123', 'US', '2022-03-10'
        UNION ALL SELECT 'c500177', 'FR', '2022-03-10'
        UNION ALL SELECT 'c500053', 'GR', '2022-03-10'
        UNION ALL SELECT 'c500390', 'MX', '2022-03-10'
        UNION ALL SELECT 'c500336', 'BR', '2022-03-10'
        UNION ALL SELECT 'c500300', 'MX', '2022-03-10'
        UNION ALL SELECT 'c500294', 'MX', '2022-03-11'
        UNION ALL SELECT 'c500009', 'GR', '2022-03-11'
        UNION ALL SELECT 'c500376', 'BR', '2022-03-11'
        UNION ALL SELECT 'c500220', 'GR', '2022-03-11'
        UNION ALL SELECT 'c500369', 'FR', '2022-03-11'
        UNION ALL SELECT 'c500193', 'FR', '2022-03-11'
        UNION ALL SELECT 'c500060', 'BR', '2022-03-12'
        UNION ALL SELECT 'c500190', 'FR', '2022-03-12'
        UNION ALL SELECT 'c500330', 'US', '2022-03-12'
        UNION ALL SELECT 'c500092', 'FR', '2022-03-12'
        UNION ALL SELECT 'c500064', 'GR', '2022-03-12'
        UNION ALL SELECT 'c500274', 'BR', '2022-03-12'
        UNION ALL SELECT 'c500183', 'GR', '2022-03-12'
        UNION ALL SELECT 'c500211', 'GR', '2022-03-13'
        UNION ALL SELECT 'c500388', 'BR', '2022-03-13'
        UNION ALL SELECT 'c500125', 'GR', '2022-03-13'
        UNION ALL SELECT 'c500368', 'FR', '2022-03-13'
        UNION ALL SELECT 'c500030', 'CA', '2022-03-14'
        UNION ALL SELECT 'c500173', 'FR', '2022-03-14'
        UNION ALL SELECT 'c500154', 'CA', '2022-03-15'
        UNION ALL SELECT 'c500097', 'FR', '2022-03-15'
        UNION ALL SELECT 'c500007', 'MX', '2022-03-15'
        UNION ALL SELECT 'c500208', 'BR', '2022-03-15'
        UNION ALL SELECT 'c500207', 'BR', '2022-03-15'
        UNION ALL SELECT 'c500239', 'BR', '2022-03-15'
        UNION ALL SELECT 'c500133', 'FR', '2022-03-15'
        UNION ALL SELECT 'c500264', 'FR', '2022-03-16'
        UNION ALL SELECT 'c500398', 'FR', '2022-03-16'
        UNION ALL SELECT 'c500172', 'MX', '2022-03-16'
        UNION ALL SELECT 'c500279', 'US', '2022-03-16'
        UNION ALL SELECT 'c500322', 'CA', '2022-03-16'
        UNION ALL SELECT 'c500291', 'US', '2022-03-16'
        UNION ALL SELECT 'c500268', 'CA', '2022-03-17'
        UNION ALL SELECT 'c500182', 'GR', '2022-03-17'
        UNION ALL SELECT 'c500281', 'MX', '2022-03-17'
        UNION ALL SELECT 'c500145', 'US', '2022-03-17'
        UNION ALL SELECT 'c500387', 'GR', '2022-03-18'
        UNION ALL SELECT 'c500042', 'GR', '2022-03-18'
        UNION ALL SELECT 'c500360', 'BR', '2022-03-18'
        UNION ALL SELECT 'c500267', 'FR', '2022-03-18'
        UNION ALL SELECT 'c500019', 'BR', '2022-03-18'
        UNION ALL SELECT 'c500074', 'BR', '2022-03-19'
        UNION ALL SELECT 'c500114', 'US', '2022-03-19'
        UNION ALL SELECT 'c500318', 'BR', '2022-03-19'
        UNION ALL SELECT 'c500371', 'FR', '2022-03-19'
        UNION ALL SELECT 'c500023', 'GR', '2022-03-20'
        UNION ALL SELECT 'c500299', 'US', '2022-03-20'
        UNION ALL SELECT 'c500041', 'US', '2022-03-20'
        UNION ALL SELECT 'c500351', 'US', '2022-03-20'
        UNION ALL SELECT 'c500115', 'BR', '2022-03-20'
        UNION ALL SELECT 'c500332', 'BR', '2022-03-21'
        UNION ALL SELECT 'c500319', 'US', '2022-03-21'
        UNION ALL SELECT 'c500139', 'FR', '2022-03-22'
        UNION ALL SELECT 'c500198', 'BR', '2022-03-22'
        UNION ALL SELECT 'c500148', 'GR', '2022-03-22'
        UNION ALL SELECT 'c500057', 'MX', '2022-03-22'
        UNION ALL SELECT 'c500282', 'US', '2022-03-22'
        UNION ALL SELECT 'c500100', 'MX', '2022-03-23'
        UNION ALL SELECT 'c500157', 'FR', '2022-03-23'
        UNION ALL SELECT 'c500122', 'BR', '2022-03-23'
        UNION ALL SELECT 'c500361', 'FR', '2022-03-23'
        UNION ALL SELECT 'c500324', 'BR', '2022-03-23'
        UNION ALL SELECT 'c500151', 'US', '2022-03-23'
        UNION ALL SELECT 'c500171', 'GR', '2022-03-24'
        UNION ALL SELECT 'c500018', 'US', '2022-03-24'
        UNION ALL SELECT 'c500292', 'CA', '2022-03-24'
        UNION ALL SELECT 'c500373', 'CA', '2022-03-24'
        UNION ALL SELECT 'c500320', 'GR', '2022-03-25'
        UNION ALL SELECT 'c500152', 'FR', '2022-03-25'
        UNION ALL SELECT 'c500200', 'MX', '2022-03-25'
        UNION ALL SELECT 'c500188', 'CA', '2022-03-25'
        UNION ALL SELECT 'c500298', 'MX', '2022-03-25'
        UNION ALL SELECT 'c500189', 'MX', '2022-03-26'
        UNION ALL SELECT 'c500231', 'US', '2022-03-26'
        UNION ALL SELECT 'c500344', 'BR', '2022-03-26'
        UNION ALL SELECT 'c500251', 'US', '2022-03-26'
        UNION ALL SELECT 'c500339', 'MX', '2022-03-27'
        UNION ALL SELECT 'c500217', 'MX', '2022-03-27'
        UNION ALL SELECT 'c500027', 'GR', '2022-03-27'
        UNION ALL SELECT 'c500164', 'CA', '2022-03-27'
        UNION ALL SELECT 'c500261', 'MX', '2022-03-27'
        UNION ALL SELECT 'c500080', 'US', '2022-03-28'
        UNION ALL SELECT 'c500161', 'BR', '2022-03-28'
        UNION ALL SELECT 'c500210', 'US', '2022-03-28'
        UNION ALL SELECT 'c500370', 'FR', '2022-03-28'
        UNION ALL SELECT 'c500256', 'US', '2022-03-29'
        UNION ALL SELECT 'c500079', 'BR', '2022-03-29'
        UNION ALL SELECT 'c500066', 'BR', '2022-03-29'
        UNION ALL SELECT 'c500197', 'BR', '2022-03-29'
        UNION ALL SELECT 'c500315', 'MX', '2022-03-29'
        UNION ALL SELECT 'c500143', 'CA', '2022-03-30'
        UNION ALL SELECT 'c500048', 'CA', '2022-03-30'
        UNION ALL SELECT 'c500056', 'GR', '2022-03-30'
        UNION ALL SELECT 'c500070', 'FR', '2022-03-30'
        UNION ALL SELECT 'c500150', 'MX', '2022-03-30'
        UNION ALL SELECT 'c500229', 'MX', '2022-03-30'
        UNION ALL SELECT 'c500221', 'BR', '2022-03-30'
        UNION ALL SELECT 'c500170', 'BR', '2022-03-30'
        UNION ALL SELECT 'c500083', 'US', '2022-03-31'
        UNION ALL SELECT 'c500049', 'BR', '2022-03-31'
        UNION ALL SELECT 'c500136', 'US', '2022-03-31'
        UNION ALL SELECT 'c500234', 'GR', '2022-03-31'
        UNION ALL SELECT 'c500061', 'GR', '2022-03-31'
        UNION ALL SELECT 'c500124', 'BR', '2022-03-31'
        UNION ALL SELECT 'c500203', 'CA', '2022-04-01'
        UNION ALL SELECT 'c500385', 'GR', '2022-04-01'
        UNION ALL SELECT 'c500384', 'CA', '2022-04-01'
        UNION ALL SELECT 'c500043', 'FR', '2022-04-01'
        UNION ALL SELECT 'c500014', 'BR', '2022-04-01'
    )
